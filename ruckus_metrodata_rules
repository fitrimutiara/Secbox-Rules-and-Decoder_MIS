<group name="ruckus,wireless,network,">

  <!-- Base rule -->
  <rule id="950100" level="0">
    <decoded_as>ruckus</decoded_as>
    <description>Ruckus Wireless Access Point events</description>
  </rule>

  <!-- Rogue AP Detection -->
  <rule id="950101" level="8">
    <if_sid>950100</if_sid>
    <action>generalRogueAPDetected</action>
    <description>Ruckus: Rogue Access Point detected - $(ssid)</description>
    <group>wireless_attack</group>
  </rule>

  <rule id="950102" level="10">
    <if_sid>950100</if_sid>
    <action>generalRogueAPDetected</action>
    <field name="rogue_type">Malicious</field>
    <description>Ruckus: Malicious Rogue AP detected - $(ssid) on $(ap_name)</description>
    <group>wireless_attack,intrusion_attempt</group>
  </rule>

  <rule id="950103" level="5">
    <if_sid>950100</if_sid>
    <action>maliciousRogueAPTimeout</action>
    <description>Ruckus: Malicious Rogue AP timeout - $(ssid)</description>
    <group>wireless_attack</group>
  </rule>

  <rule id="950104" level="12">
    <if_sid>950100</if_sid>
    <action>generalRogueAPDetected</action>
    <field name="rogue_rule">Same Network Rule</field>
    <description>Ruckus: Rogue AP on same network detected - $(ssid) MAC: $(rogue_mac)</description>
    <group>wireless_attack,intrusion_attempt</group>
  </rule>

  <!-- Channel Change -->
  <rule id="950110" level="3">
    <if_sid>950100</if_sid>
    <action>apChannelChanged</action>
    <description>Ruckus: AP channel changed on $(ap_name) from $(from_channel) to $(to_channel)</description>
    <group>wireless_configuration</group>
  </rule>

  <rule id="950111" level="8" frequency="5" timeframe="300">
    <if_matched_sid>950110</if_matched_sid>
    <same_field>ap_mac</same_field>
    <description>Ruckus: Frequent channel changes on $(ap_name)</description>
    <group>wireless_attack,wireless_configuration</group>
  </rule>

  <!-- Config -->
  <rule id="950120" level="3">
    <if_sid>950100</if_sid>
    <action>apConfApplying</action>
    <description>Ruckus: Configuration applying on AP $(ap_name)</description>
    <group>wireless_configuration</group>
  </rule>

  <rule id="950121" level="7">
    <if_sid>950100</if_sid>
    <action>apConfUpdateFailed</action>
    <description>Ruckus: Configuration update failed on AP $(ap_name)</description>
    <group>wireless_configuration,system_error</group>
  </rule>

  <rule id="950122" level="12" frequency="5" timeframe="300">
    <if_matched_sid>950121</if_matched_sid>
    <same_field>ap_mac</same_field>
    <description>Ruckus: Multiple configuration update failures on AP $(ap_name)</description>
    <group>wireless_configuration,system_error</group>
  </rule>

  <!-- Health -->
  <rule id="950130" level="7">
    <if_sid>950100</if_sid>
    <action>apHealthAirtimeUtilizationFlag</action>
    <description>Ruckus: High airtime utilization on $(ap_name)</description>
    <group>wireless_performance</group>
  </rule>

  <rule id="950131" level="3">
    <if_sid>950100</if_sid>
    <action>apHealthAirtimeUtilizationClear</action>
    <description>Ruckus: Airtime utilization cleared on $(ap_name)</description>
    <group>wireless_performance</group>
  </rule>

  <rule id="950132" level="10" frequency="3" timeframe="600">
    <if_matched_sid>950130</if_matched_sid>
    <same_field>ap_mac</same_field>
    <description>Ruckus: Persistent high airtime utilization on $(ap_name)</description>
    <group>wireless_performance,service_availability</group>
  </rule>

  <!-- Login -->
  <rule id="950150" level="3">
    <if_sid>950100</if_sid>
    <action>szLogin</action>
    <description>Ruckus: User login to system</description>
    <group>authentication_success</group>
  </rule>

  <!-- Correlation -->
  <rule id="950160" level="10" frequency="3" timeframe="300">
    <if_matched_sid>950101</if_matched_sid>
    <description>Ruckus: Multiple rogue APs detected</description>
    <group>wireless_attack,intrusion_attempt</group>
  </rule>

  <rule id="950161" level="12" frequency="5" timeframe="600">
    <if_matched_sid>950101</if_matched_sid>
    <same_field>ap_mac</same_field>
    <description>Ruckus: Same AP detecting multiple rogue APs</description>
    <group>wireless_attack,intrusion_attempt</group>
  </rule>

</group>
